# SPL size optimization for imx93-jaguar-eink
# Target: Reduce SPL size by additional 3528+ bytes
# Current overflow: 3528 bytes beyond .sram limit

# === Disable Non-Essential SPL Features ===
# Remove command line support from SPL (saves significant space)
CONFIG_SPL_CMDLINE=n
CONFIG_SPL_CLI=n

# Disable SPL environment support (not needed for basic boot)
CONFIG_SPL_ENV_SUPPORT=n

# Disable SPL networking (not needed in SPL for this board)
CONFIG_SPL_NET=n
CONFIG_SPL_ETH=n

# Disable SPL USB support (not essential for basic boot)
CONFIG_SPL_USB_HOST=n
CONFIG_SPL_USB_STORAGE=n

# Disable SPL filesystem support (minimal boot only)
CONFIG_SPL_FS_FAT=n
CONFIG_SPL_FS_EXT4=n

# === Optimize Memory Layout ===
# Reduce SPL malloc pool size
CONFIG_SPL_SYS_MALLOC_F_LEN=0x2000

# Disable SPL banner/version info
CONFIG_SPL_DISPLAY_PRINT=n

# === Disable Debug Features ===
# Remove all debug output from SPL
CONFIG_SPL_LOG=n
CONFIG_SPL_LOG_MAX_LEVEL=0

# Disable SPL profiling
CONFIG_SPL_BOOTSTAGE=n

# === Optimize Non-Security Features ===
# Keep all security features intact - optimize other areas instead

# === Minimize Device Support ===
# Only essential devices in SPL
CONFIG_SPL_DM_DEVICE_REMOVE=n
CONFIG_SPL_SIMPLE_BUS=y

# === Optimize Build Settings ===
# Use smaller printf implementation
CONFIG_SPL_USE_TINY_PRINTF=y

# Disable SPL banner
CONFIG_SPL_BANNER_PRINT=n

# === AGGRESSIVE NON-SECURITY SIZE OPTIMIZATION ===
# Maximize size savings while preserving all security features

# Reduce SPL malloc pool even further (was 0x2000, now 0x1000)
CONFIG_SPL_SYS_MALLOC_F_LEN=0x1000

# Disable more non-essential SPL features
CONFIG_SPL_WATCHDOG=n
CONFIG_SPL_GPIO=n
CONFIG_SPL_THERMAL=n
CONFIG_SPL_POWER_DOMAIN=n

# Minimize SPL device tree support (keep basic functionality)
CONFIG_SPL_OF_LIBFDT=y
CONFIG_SPL_OF_CONTROL=y
# But disable advanced device tree features
CONFIG_SPL_MULTI_DTB_FIT=n

# Disable SPL image loading features not needed for basic boot
CONFIG_SPL_LOAD_FIT=n
CONFIG_SPL_FIT_IMAGE_TINY=y

# Disable SPL MMC write support (read-only for boot)
CONFIG_SPL_MMC_WRITE=n

# Use minimal SPL stack size
CONFIG_SPL_STACK_R=n

# Disable SPL random number generation
CONFIG_SPL_DM_RNG=n

# Disable SPL timer support (use basic timing)
CONFIG_SPL_TIMER=n
