# ===== ALSA config for TAS2563 with TAS2562 driver =====

# ---- TAS2562 Driver Configuration ----
# The TAS2562 driver provides basic amplifier functionality for TAS2563 codec
# Available controls:
#   - "Amp Gain Volume": Hardware amplifier gain (0-28, ~1dB steps)
#   - "Digital Volume Control": Digital volume control (0-110)
# Note: TAS2562 driver does not support DSP modes, regbin profiles, or PDM microphones

# ---- Physical Speaker (used by pipeline as "spk") ----
pcm.spk {
    type hw
    card tas2563audio
    device 0
}
ctl.spk { type hw card tas2563audio }

pcm.!default {
    type plug
    slave.pcm "spk"
}

ctl.!default { type hw card tas2563audio }

# ---- Physical Microphones ----
# MICFIL PDM microphones (original hardware)
pcm.mic {
    type hw
    card micfilaudio
    device 0
    channels 2
}
ctl.mic { type hw card micfilaudio }

# TAS2562 driver does not support PDM microphones
# Use MICFIL for microphone input instead

# ---- Loopback pair 0: Azure TTS -> AEC probe ----
pcm.loop_playback_far {  # write here from Azure TTS
    type hw
    card Loopback
    device 0
    subdevice 0
}

pcm.loop_capture_far {   # read here for webrtcechoprobe
    type hw
    card Loopback
    device 1
    subdevice 0
}

# ---- Loopback pair 1: AEC output -> consumers (e.g., STT) ----
pcm.loop_playback_near {  # AEC writes cleaned audio here
    type hw
    card Loopback
    device 0
    subdevice 1
}
pcm.loop_capture_near {   # single-open reader of cleaned audio
    type hw
    card Loopback
    device 1
    subdevice 1
}

# wakeword
pcm.loop_playback_near_wake { type hw; card Loopback; device 0; subdevice 2 }
pcm.loop_capture_near_wake  { type hw; card Loopback; device 1; subdevice 2 }

# stopword
pcm.loop_playback_near_stop { type hw; card Loopback; device 0; subdevice 3 }
pcm.loop_capture_near_stop  { type hw; card Loopback; device 1; subdevice 3 }

# barge-in
pcm.loop_playback_near_barge { type hw; card Loopback; device 0; subdevice 4 }
pcm.loop_capture_near_barge  { type hw; card Loopback; device 1; subdevice 4 }

# recording
pcm.loop_playback_near_rec { type hw; card Loopback; device 0; subdevice 5 }
pcm.loop_capture_near_rec  { type hw; card Loopback; device 1; subdevice 5 }



# ===== TAS2562 Driver - Basic Audio Only =====
# The TAS2562 driver provides basic speaker output only
# No multi-channel capture, PDM microphones, or echo reference support
# Use MICFIL for microphone input and external AEC processing

# ===== TAS2562 Driver Notes =====
# The TAS2562 driver provides basic I2S audio amplification
# No profile management, DSP modes, or advanced features
# Simple volume control via "Amp Gain Volume" and "Digital Volume Control"
