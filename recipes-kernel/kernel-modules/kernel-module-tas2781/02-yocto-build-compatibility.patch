From 29c673b2f992f0aa4a8bf1fa5f229c95cc3c506e Mon Sep 17 00:00:00 2001
From: Alex J Lennon <ajlennon@dynamicdevices.co.uk>
Date: Sun, 1 Sep 2024 14:19:04 +0100
Subject: [PATCH] Changes to build under Yocto

Signed-off-by: Alex J Lennon <ajlennon@dynamicdevices.co.uk>
---
 src/Makefile | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

diff --git a/src/Makefile b/src/Makefile
index d916d07..a9d01d6 100644
--- a/src/Makefile
+++ b/src/Makefile
@@ -13,4 +13,12 @@ snd-soc-integrated-tasdevice-objs	:=	tasdevice-core.o \
 							tasdevice-dsp_kernel.o \
 							tasdevice-dsp_git.o
 
-obj-$(CONFIG_SND_SOC_INTEGRATED_TASDEVICE)		+= snd-soc-integrated-tasdevice.o
+obj-m					+= snd-soc-integrated-tasdevice.o
+
+SRC := $(shell pwd)
+
+all:
+	$(MAKE) -C $(KERNEL_SRC) M=$(SRC) modules
+
+modules_install:
+	$(MAKE) -C $(KERNEL_SRC) M=$(SRC) modules_install
-- 
2.34.1

