# Remove unnecessary drivers for imx93-jaguar-eink
# Optimize for eInk board with WiFi/BT/802.15.4 connectivity only
# This reduces kernel size and boot time significantly

# === Graphics Drivers (optimized for eInk display) ===
# Keep essential DRM framework for eInk display
CONFIG_DRM=y
CONFIG_DRM_KMS_HELPER=y
CONFIG_DRM_GEM_DMA_HELPER=y
CONFIG_DRM_PANEL=y
CONFIG_DRM_BRIDGE=y
CONFIG_DRM_PANEL_SIMPLE=y  # Keep for eInk panels

# Keep i.MX display controllers that might be used for eInk
CONFIG_DRM_IMX=y
CONFIG_DRM_IMX_DCSS=y
CONFIG_DRM_IMX_LCDIF=y
CONFIG_DRM_IMX_PARALLEL=y

# Remove unnecessary display outputs
CONFIG_DRM_IMX_LDB=n        # LVDS bridge (not for eInk)
CONFIG_DRM_IMX_TVE=n        # TV encoder
CONFIG_DRM_IMX_HDMI=n       # HDMI output
CONFIG_DRM_DW_HDMI_IMX=n    # DesignWare HDMI
CONFIG_DRM_DW_HDMI=n        # DesignWare HDMI core
CONFIG_DRM_DW_HDMI_CEC=n    # HDMI CEC interface
CONFIG_DRM_MIPI_DSI=n       # MIPI DSI (unless your eInk uses DSI)

# Remove 3D GPU acceleration (not needed for eInk)
CONFIG_DRM_ETNAVIV=n
CONFIG_DRM_VIVANTE=n

# === Camera/Video Drivers ===
CONFIG_MEDIA_CAMERA_SUPPORT=n
CONFIG_VIDEO_IMX_MEDIA=n
CONFIG_VIDEO_MXC_OUTPUT=n
CONFIG_VIDEO_MXC_CAPTURE=n
CONFIG_VIDEO_V4L2=n
CONFIG_VIDEOBUF2_CORE=n
CONFIG_VIDEOBUF2_V4L2=n
CONFIG_VIDEOBUF2_MEMOPS=n
CONFIG_VIDEOBUF2_DMA_CONTIG=n

# === Explicitly disable specific camera drivers ===
CONFIG_VIDEO_MXC_CSI_CAMERA=n
CONFIG_MXC_MIPI_CSI=n
CONFIG_MXC_CAMERA_OV5640_MIPI_V2=n

# === GPU/3D Acceleration (keep display core, remove 3D) ===
CONFIG_MXC_GPU_VIV=n        # 3D GPU acceleration not needed for eInk
CONFIG_IMX_DPU_CORE=y       # Keep display processing unit for advanced eInk
CONFIG_IMX_LCDIF_CORE=y     # Keep LCD interface for eInk display
CONFIG_IMX_DCSS_CORE=y      # Keep display controller for eInk

# === USB Gadget Drivers (keep minimal) ===
CONFIG_USB_GADGET_STORAGE_NUM_BUFFERS=2  # Reduce from default
CONFIG_USB_F_MASS_STORAGE=n
CONFIG_USB_MASS_STORAGE=n
CONFIG_USB_F_PRINTER=n
CONFIG_USB_F_ACM=y  # Keep for LTE modem
CONFIG_USB_F_SERIAL=y  # Keep for LTE modem
CONFIG_USB_F_ECM=n
CONFIG_USB_F_RNDIS=n
CONFIG_USB_F_HID=n

# === Ethernet Drivers (not present on board) ===
CONFIG_FEC=n
CONFIG_PHYLIB=n
CONFIG_AT803X_PHY=n
CONFIG_MICREL_PHY=n
CONFIG_REALTEK_PHY=n
CONFIG_FIXED_PHY=n

# === PCIe (minimal support needed for WiFi module) ===
CONFIG_PCI=y
CONFIG_PCIEPORTBUS=y
CONFIG_PCI_MSI=y
CONFIG_PCI_IMX6=n

# === CAN Bus (not needed) ===
CONFIG_CAN=n
CONFIG_CAN_FLEXCAN=n
CONFIG_CAN_M_CAN=n

# === Industrial I/O (enable for sensors) ===
# Keep IIO framework for onboard sensors (IMU, pressure, etc.)
CONFIG_IIO=y
CONFIG_IIO_BUFFER=y
CONFIG_IIO_KFIFO_BUF=y
CONFIG_IIO_TRIGGERED_BUFFER=y
CONFIG_IIO_SW_DEVICE=y
CONFIG_IIO_SW_TRIGGER=y

# === Hardware Monitoring (minimal) ===
CONFIG_HWMON=y
CONFIG_THERMAL_HWMON=y
CONFIG_IMX_THERMAL=y  # Keep for CPU thermal
# Remove other HWMON drivers
CONFIG_SENSORS_LM75=n
CONFIG_SENSORS_LM90=n
CONFIG_SENSORS_INA2XX=n

# === Watchdog (keep minimal) ===
CONFIG_WATCHDOG=y
CONFIG_IMX2_WDT=y  # Keep i.MX watchdog
CONFIG_WATCHDOG_CORE=y

# === Multi-Function Device Drivers ===
# Keep only essential MFD drivers
CONFIG_MFD_CORE=y
CONFIG_MFD_SYSCON=y
CONFIG_MFD_PCA9450=y  # PMIC
# Remove unnecessary MFD
CONFIG_MFD_DA9062=n
CONFIG_MFD_DA9063=n
CONFIG_MFD_MAX77620=n
CONFIG_MFD_MAX77686=n
CONFIG_MFD_MAX77714=n
CONFIG_MFD_RK808=n
CONFIG_MFD_BD9571MWV=n

# === Explicitly disable PMIC drivers not present on board ===
CONFIG_PINCTRL_MAX77620=n
CONFIG_GPIO_MAX77620=n
CONFIG_GPIO_BD9571MWV=n
CONFIG_REGULATOR_BD9571MWV=n
CONFIG_RTC_DRV_MAX77686=n

# === LED Drivers (minimal) ===
CONFIG_LEDS_CLASS=y
CONFIG_LEDS_GPIO=y
CONFIG_LEDS_PWM=n
CONFIG_LEDS_LP50XX=n  # Not used on eInk board

# === Power Supply Drivers ===
CONFIG_POWER_SUPPLY=y
CONFIG_POWER_SUPPLY_HWMON=y
# Remove battery-specific drivers not relevant for eInk
CONFIG_BATTERY_SBS=n
CONFIG_CHARGER_ISP1704=n
CONFIG_CHARGER_MAX77693=n

# === Regulator Drivers (keep essential) ===
CONFIG_REGULATOR=y
CONFIG_REGULATOR_FIXED_VOLTAGE=y
CONFIG_REGULATOR_GPIO=y
CONFIG_REGULATOR_PCA9450=y  # PMIC regulator
# Remove unused regulators
CONFIG_REGULATOR_DA9210=n
CONFIG_REGULATOR_DA9211=n
CONFIG_REGULATOR_MAX77620=n

# === PWM (minimal) ===
CONFIG_PWM=y
CONFIG_PWM_IMX27=y  # Keep i.MX PWM
CONFIG_PWM_IMX_TPM=n

# === DMA Engine (keep essential) ===
CONFIG_DMADEVICES=y
CONFIG_IMX_DMA=y
CONFIG_IMX_SDMA=y
CONFIG_FSL_EDMA=y
# Remove unnecessary DMA drivers
CONFIG_AMBA_PL08X=n
CONFIG_DW_DMAC=n

# === Cryptographic Hardware ===
CONFIG_CRYPTO_HW=y
CONFIG_CRYPTO_DEV_FSL_CAAM=y  # Keep CAAM for security
CONFIG_CRYPTO_DEV_FSL_CAAM_RING_SIZE=9
CONFIG_CRYPTO_DEV_FSL_CAAM_INTC=y
CONFIG_CRYPTO_DEV_FSL_CAAM_CRYPTO_API_DESC=y
# Remove other crypto accelerators
CONFIG_CRYPTO_DEV_SAHARA=n

# === Pin Control (keep minimal) ===
CONFIG_PINCTRL=y
CONFIG_PINCTRL_IMX=y
CONFIG_PINCTRL_IMX93=y
# Remove unused pinctrl drivers
CONFIG_PINCTRL_SINGLE=n

# === Clock Drivers (keep essential) ===
CONFIG_COMMON_CLK=y
CONFIG_COMMON_CLK_IMX8MP=y
CONFIG_CLK_IMX8MP=y
CONFIG_CLK_IMX93=y

# === Reset Controllers ===
CONFIG_RESET_CONTROLLER=y
CONFIG_RESET_IMX7=y

# === Mailbox ===
CONFIG_MAILBOX=y
CONFIG_IMX_MBOX=y

# === NVMEM ===
CONFIG_NVMEM=y
CONFIG_NVMEM_IMX_OCOTP=y
CONFIG_NVMEM_IMX_OCOTP_SCU=n

# === Hardware Spinlock ===
CONFIG_HWSPINLOCK=y
CONFIG_HWSPINLOCK_IMX=y

# === Remoteproc (for M33 core) ===
CONFIG_REMOTEPROC=y
CONFIG_IMX_REMOTEPROC=y

# === RPMSG ===
CONFIG_RPMSG=y
CONFIG_RPMSG_VIRTIO=y
