# Power optimization configuration for imx93-jaguar-eink 5-year battery life
# Priority: Power efficiency over performance for maximum battery life

# === CPU Power Management (Change 1) ===
# IMPORTANT: i.MX93 uses system-wide mode switching (OD/ND/LD) instead of standard CPUFreq
# Based on i.MX Linux Reference Manual RM00293 Section 2.5.1
CONFIG_IMX93_LPM=y                       # i.MX93 Low Power Management driver (CRITICAL)
CONFIG_CPU_FREQ=y
CONFIG_CPU_FREQ_DEFAULT_GOV_POWERSAVE=y  # Use powersave governor by default
CONFIG_CPU_FREQ_GOV_POWERSAVE=y
CONFIG_CPU_FREQ_GOV_ONDEMAND=y
CONFIG_CPU_FREQ_GOV_CONSERVATIVE=y
CONFIG_CPU_FREQ_GOV_USERSPACE=y

# i.MX93 specific frequency scaling
CONFIG_ARM_IMX_CPUFREQ_DT=y
CONFIG_CPUFREQ_DT=y
CONFIG_CPUFREQ_DT_PLATDEV=y

# === CPU Idle States (Change 2) ===
CONFIG_CPU_IDLE=y
CONFIG_CPU_IDLE_GOV_LADDER=y
CONFIG_CPU_IDLE_GOV_MENU=y
CONFIG_CPU_IDLE_GOV_TEO=y
CONFIG_ARM_CPUIDLE=y

# === Dynamic Voltage and Frequency Scaling (Change 2) ===
CONFIG_PM_DEVFREQ=y
CONFIG_DEVFREQ_GOV_SIMPLE_ONDEMAND=y
CONFIG_DEVFREQ_GOV_POWERSAVE=y
CONFIG_DEVFREQ_GOV_USERSPACE=y
CONFIG_ARM_IMX_BUS_DEVFREQ=y

# === Power Domain Management ===
CONFIG_PM_GENERIC_DOMAINS=y
CONFIG_PM_GENERIC_DOMAINS_SLEEP=y
CONFIG_PM_GENERIC_DOMAINS_OF=y
CONFIG_IMX_GPCV2_PM_DOMAINS=y

# === Runtime Power Management (Change 5) ===
CONFIG_PM_RUNTIME=y
CONFIG_PM_RUNTIME_CLK=y
CONFIG_PM_CLK=y
CONFIG_PM_GENERIC_DOMAINS_RUNTIME=y

# === WiFi Power Management (Change 3) ===
CONFIG_CFG80211_WEXT=y
CONFIG_MAC80211_HAS_RC=y
CONFIG_MAC80211_RC_MINSTREL=y

# === Memory Power Management (Change 6) ===
CONFIG_CMA=y
CONFIG_CMA_SIZE_MBYTES=16  # Reduced from 32MB for power savings
CONFIG_ZRAM=y              # Compressed RAM to reduce memory usage
CONFIG_ZSMALLOC=y
CONFIG_LZO_COMPRESS=y
CONFIG_LZ4_COMPRESS=y

# === Regulator Support for DVFS ===
CONFIG_REGULATOR=y
CONFIG_REGULATOR_ANATOP=y
CONFIG_REGULATOR_PCA9450=y  # PMIC support for voltage scaling

# === Thermal Management for Power ===
CONFIG_THERMAL=y
CONFIG_THERMAL_DEFAULT_GOV_STEP_WISE=y
CONFIG_THERMAL_GOV_STEP_WISE=y
CONFIG_THERMAL_GOV_POWER_ALLOCATOR=y
CONFIG_IMX_THERMAL=y

# === Advanced Power Management ===
CONFIG_PM_ADVANCED_DEBUG=n  # Disable debug for power savings
CONFIG_PM_DEBUG=n           # Disable debug for power savings
CONFIG_PM_TRACE=n           # Disable trace for power savings
