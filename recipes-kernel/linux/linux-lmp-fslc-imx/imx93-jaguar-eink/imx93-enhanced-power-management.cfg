# i.MX93 Enhanced Power Management Configuration for MCXC143VFM Integration
# Optimized for custom microcontroller power management approach
# Target: 5-year battery life for E-Ink board

# === i.MX93 Low Power Management (CRITICAL) ===
CONFIG_IMX93_LPM=y                       # i.MX93 Low Power Management driver - ENABLES CPU FREQ SCALING
CONFIG_IMX93_LPM_CPUIDLE=y               # CPU idle integration with LPM
CONFIG_IMX93_BUSFREQ=y                   # Bus frequency scaling for DDR power savings

# === Enhanced CPU Power Management ===
CONFIG_CPU_FREQ=y
CONFIG_CPU_FREQ_STAT=y                   # Frequency statistics for monitoring
CONFIG_CPU_FREQ_TIMES=y                  # Per-CPU time in state tracking
CONFIG_CPU_FREQ_DEFAULT_GOV_POWERSAVE=y  # Default to maximum power savings
CONFIG_CPU_FREQ_GOV_POWERSAVE=y
CONFIG_CPU_FREQ_GOV_ONDEMAND=y
CONFIG_CPU_FREQ_GOV_CONSERVATIVE=y
CONFIG_CPU_FREQ_GOV_USERSPACE=y          # Allow manual control
CONFIG_CPU_FREQ_GOV_SCHEDUTIL=y          # Scheduler-guided frequency scaling
CONFIG_CPUFREQ_DT=y
CONFIG_ARM_IMX_CPUFREQ_DT=y              # i.MX CPU frequency scaling driver

# === Advanced CPU Idle Management ===
CONFIG_CPU_IDLE=y
CONFIG_CPU_IDLE_GOV_LADDER=y
CONFIG_CPU_IDLE_GOV_MENU=y               # Default governor - good for power
CONFIG_CPU_IDLE_GOV_TEO=y                # Timer events oriented governor
CONFIG_ARM_CPUIDLE=y
CONFIG_DT_IDLE_STATES=y                  # Device tree idle state support

# === i.MX93 Power Domain Management ===
CONFIG_PM_GENERIC_DOMAINS=y
CONFIG_PM_GENERIC_DOMAINS_SLEEP=y        # Power domain sleep support
CONFIG_PM_GENERIC_DOMAINS_OF=y           # Device tree power domain support
CONFIG_PM_GENERIC_DOMAINS_RUNTIME=y      # Runtime power domain management
CONFIG_IMX_GPCV2_PM_DOMAINS=y            # i.MX93 Generic Power Controller v2

# === Memory Power Optimizations ===
CONFIG_PM_DEVFREQ=y                      # Device frequency scaling
CONFIG_DEVFREQ_GOV_SIMPLE_ONDEMAND=y
CONFIG_DEVFREQ_GOV_POWERSAVE=y           # DDR frequency powersave governor
CONFIG_DEVFREQ_GOV_USERSPACE=y           # Manual DDR frequency control
CONFIG_DEVFREQ_GOV_PASSIVE=y
CONFIG_ARM_IMX_BUS_DEVFREQ=y             # i.MX bus frequency scaling

# === Clock Framework Power Management ===
CONFIG_PM_CLK=y                          # Clock power management
CONFIG_PM_RUNTIME_CLK=y                  # Runtime PM clock support
CONFIG_COMMON_CLK=y
CONFIG_COMMON_CLK_IMX93=y                # i.MX93 clock support

# === Thermal Management for Power Efficiency ===
CONFIG_THERMAL=y
CONFIG_THERMAL_DEFAULT_GOV_STEP_WISE=y   # Gradual thermal response
CONFIG_THERMAL_GOV_STEP_WISE=y
CONFIG_THERMAL_GOV_POWER_ALLOCATOR=y     # Power-aware thermal management
CONFIG_THERMAL_GOV_FAIR_SHARE=y
CONFIG_THERMAL_GOV_USER_SPACE=y
CONFIG_IMX_THERMAL=y                     # i.MX thermal driver
CONFIG_IMX_SC_THERMAL=y                  # i.MX system controller thermal

# === Advanced Power Management ===
CONFIG_PM=y
CONFIG_PM_SLEEP=y
CONFIG_PM_RUNTIME=y
CONFIG_PM_ADVANCED_DEBUG=y               # Enable for power debugging
CONFIG_PM_DEBUG=y                        # Power management debugging
CONFIG_PM_TRACE=y                        # PM trace events

# === Suspend/Resume Optimizations ===
CONFIG_SUSPEND=y
CONFIG_SUSPEND_FREEZER=y
CONFIG_SUSPEND_SKIP_SYNC=n               # Don't skip sync for data integrity
CONFIG_PM_SLEEP_SMP=y
CONFIG_PM_AUTOSLEEP=n                    # Disable autosleep for manual control
CONFIG_PM_WAKELOCKS=y
CONFIG_PM_WAKELOCKS_LIMIT=100
CONFIG_PM_WAKELOCKS_GC=y

# === Regulator Framework (for MCXC143VFM integration) ===
CONFIG_REGULATOR=y
CONFIG_REGULATOR_FIXED_VOLTAGE=y         # Fixed voltage regulators
CONFIG_REGULATOR_GPIO=y                  # GPIO-controlled regulators
CONFIG_REGULATOR_USERSPACE_CONSUMER=y    # Userspace regulator control

# === Enhanced I/O Power Management ===
# UART Power Management
CONFIG_SERIAL_FSL_LPUART=y
CONFIG_SERIAL_FSL_LPUART_CONSOLE=y
CONFIG_SERIAL_FSL_LPUART_PM=y            # LPUART power management

# I2C Power Management  
CONFIG_I2C_IMX=y
CONFIG_I2C_IMX_LPI2C=y                   # Low Power I2C

# SPI Power Management
CONFIG_SPI_IMX=y
CONFIG_SPI_FSL_LPSPI=y                   # Low Power SPI

# MMC/SDIO Power Management (for WiFi)
CONFIG_MMC_SDHCI_ESDHC_IMX=y
CONFIG_MMC_SDHCI_ESDHC_IMX_PM=y          # Enhanced SDHCI power management

# USB Power Management
CONFIG_USB_SUSPEND=y
CONFIG_USB_DEFAULT_PERSIST=y

# === Network Power Management ===
CONFIG_CFG80211_WEXT=y
CONFIG_MAC80211_HAS_RC=y
CONFIG_MAC80211_RC_MINSTREL=y

# === Memory Optimizations for Power ===
CONFIG_CMA=y
CONFIG_CMA_SIZE_MBYTES=16                # Reduced CMA for power savings
CONFIG_ZRAM=y                            # Compressed RAM
CONFIG_ZSMALLOC=y
CONFIG_LZO_COMPRESS=y
CONFIG_LZ4_COMPRESS=y

# === Disable Power-Hungry Features ===
CONFIG_HIBERNATION=n                     # Disable hibernation
CONFIG_PM_STD_PARTITION=""               # No hibernate partition

# === MCXC143VFM Microcontroller Integration ===
# GPIO support for microcontroller communication
CONFIG_GPIOLIB=y
CONFIG_GPIO_SYSFS=y                      # Userspace GPIO access
CONFIG_GPIO_MXC=y                        # i.MX GPIO support

# === Wake Sources ===
CONFIG_RTC_HCTOSYS=y                     # RTC as system time source
CONFIG_RTC_SYSTOHC=y                     # System time to RTC
CONFIG_RTC_DRV_PCF2127=y                 # PCF2131 RTC support

# === Additional Power Optimizations ===
CONFIG_NO_HZ=y                           # Dynamic ticks
CONFIG_NO_HZ_COMMON=y
CONFIG_NO_HZ_IDLE=y                      # No Hz when idle
CONFIG_NO_HZ_FULL=y                      # Full tickless operation
CONFIG_RCU_NOCB_CPU=y                    # RCU callback offloading
CONFIG_CPU_ISOLATION=y                   # CPU isolation support
